import*as e from"react";var t;!function(e){e.players={};var t=function(){function t(e){this._volume=1,this._playbackRate=1,this._qualityLevel="auto",this._currentTime=0,this._duration=0,this._email=null,this._loaded=0,this._listeners={},this._events=e.events,this._iframe=this.findOrCreateIframe(e),window.addEventListener("message",this.routePlayerEvent,!1)}return t.prototype.play=function(e){var t=e?'{"name":"playVideo", "data":"'.concat(e,'"}'):'{"name":"play"}';this.sendMessage(t)},t.prototype.pause=function(){this.sendMessage('{"name":"pause"}')},t.prototype.getEvents=function(){return this._events},t.prototype.setVolume=function(e){this.sendMessage('{"name":"volume", "data":"'.concat(e,'"}'))},t.prototype.bind=function(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)},t.prototype.fire=function(e){var t=this,a="string"==typeof e?e:e.type,r=this._listeners[a];r&&r.forEach((function(a){"string"!=typeof e&&(e.target=t),a(e)}))},t.prototype.updateStatus=function(e){switch(e.type){case"volume":this._volume=e.data;break;case"progress":this._currentTime=e.data.time;break;case"loading":this._loaded=e.data;break;case"ready":this._duration=e.data.duration,this._email=e.data.email,this._qualityLevel=e.data.qualityLevel;break;case"rateChange":this._playbackRate=e.data;break;case"qualityLevelChange":this._qualityLevel=e.data}},t.prototype.unbind=function(e,t){var a=this._listeners[e];if(a){var r=a.indexOf(t);-1!==r&&a.splice(r,1)}},t.prototype.sendMessage=function(e){var t;null===(t=this._iframe.contentWindow)||void 0===t||t.postMessage(e,window.location.protocol+"//videos.sproutvideo.com")},t.prototype.routePlayerEvent=function(e){},t.prototype.findOrCreateIframe=function(t){if(t.target)return t.target;for(var a=t.videoId||t.playlistId,r=e.utils.getElementsByClassName("sproutvideo-player"),n=0;n<r.length;n++){var s=r[n].getAttribute("src");if(s&&a&&-1!==s.indexOf(a))return r[n]}throw new Error("Cannot find video iframe.")},t}();function a(t){if("videos.sproutvideo.com"==t.origin.split("//")[1])try{var a=JSON.parse(t.data),r=e.players[a.id];if(r){r.updateStatus(a),r.fire({type:a.type,data:a.data});var n=r.getEvents();(null==n?void 0:n.onStatus)&&n.onStatus(a)}}catch(t){}}e.PlayerImpl=t,e.routePlayerEvent=a,(e.utils||(e.utils={})).getElementsByClassName=function(e){var t=[];if(document.getElementsByClassName){var a=document.getElementsByClassName(e);t.push.apply(t,Array.from(a))}else for(var r=document.getElementsByTagName("*"),n=0;n<r.length;n++)(" "+r[n].className+" ").indexOf(" "+e+" ")>-1&&t.push(r[n]);return t},window.addEventListener("message",a,!1)}(t||(t={}));var a=e.forwardRef((function(a,r){var n=e.useRef(),s=e.useRef(null);return e.useImperativeHandle(r,(function(){return{play:function(){var e;null===(e=n.current)||void 0===e||e.play()},pause:function(){},progress:function(){return{percent:0,time:0}}}})),e.useEffect((function(){s.current&&(console.log(s.current),n.current=new t.PlayerImpl({videoId:a.id}))}),[s.current]),e.createElement("iframe",{src:a.url,ref:s,className:"sproutvideo-player"})}));export{a as SproutVideoPlayer};
//# sourceMappingURL=index.js.map
